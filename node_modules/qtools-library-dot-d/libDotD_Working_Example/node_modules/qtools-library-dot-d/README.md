# qtools-library-dot-d

# NOT READY. STILL WORKING IT OUT.

NAME

    qtools-library-dot-d

DESCRIPTION

Utility provides tools to scan a directory for NodeJS modules, require() them into existance with tools to connect them to a system.



First use case is adding endpoints to an expressJS system. When instantiated, qtDotD

scans a directory containing modules, dotLib.d. It requires it with two parameters,

dotD and passThroughArgs. For this case, passThrough args has two properties, 

expressApp and routingPrefix. The module uses these to construct one or more 

expressJS endpoitns.



the dotD object contains three parameters, add....

ASYNCHRONOUS CODE SAMPLE

const promptObjects = require('qtools-library-dot-d')({
	libraryName: 'promptObjects',
}, callback);
promptObjects.setLibraryPath(path.join(__dirname, 'prompts.d'), callback);

const passThroughParameters = {};
promptObjects.loadModules({ passThroughParameters }, callback);
promptObjects.seal(); //make the library immutable



SYNCHROMOUS CODE SAMPLE:

const promptObjects = require('qtools-library-dot-d')({
	libraryName: 'promptObjects',
});
promptObjects.setLibraryPath(path.join(__dirname, 'prompts.d'));

const passThroughParameters = {};
promptObjects.loadModules({ passThroughParameters });
promptObjects.seal(); //make the library immutable


COMPLETE WORKING CODE SAMPLE

// ================================================================================
// index.js for demonstration

#!/usr/bin/env node
'use strict';
// Suppress punycode deprecation warning
process.noDeprecation = true;

const moduleName = __filename.replace(__dirname + '/', '').replace(/.js$/, ''); //this just seems to come in handy a lot

// const qt = require('qtools-functional-library'); //also exposes qtLog(); qt.help({printOutput:true, queryString:'.*', sendJson:false});

const os = require('os');
const path = require('path');
const fs = require('fs');

const qtLibDotD = require('qtools-library-dot-d');

//START OF moduleFunction() ============================================================
const moduleFunction =
	({ moduleName } = {}) =>
	({ unused } = {}) => {
	
		// ========================================================================
		// SYNCHRONOUS DEMO

		const synchronousDemo = () => {
			const demoDotD = qtLibDotD({
				libraryName: 'demoDotD',
			});

			const libraryModulesPath = path.join(__dirname, 'demoModules_DotD');

			const passThroughParameters = {
				message: 'Hello from a dotDlib module',
				add: (a, b) => a + b,
			};

			demoDotD.setLibraryPath(libraryModulesPath);
			demoDotD.loadModules({ passThroughParameters });
			demoDotD.seal();

			// console.log(demoDotD.qtdProcessLog());
			console.log(demoDotD.toString());

			demoDotD.demo1();
			demoDotD.demo2(10, 7);
		};
			console.log(`SYNCHRONOUS DEMO =====================================`);
			synchronousDemo();
	
		// ========================================================================
		// ASYNCHRONOUS DEMO

		const asynchronousDemo = (callback) => {
			const localCallback = (err) => {
				demoDotD.seal();
				callback(err, demoDotD);
			};

			const demoDotD = qtLibDotD({
				libraryName: 'demoDotD',
			});

			const libraryModulesPath = path.join(__dirname, 'demoModules_DotD');

			const passThroughParameters = {
				message: 'Hello from a dotDlib module',
				add: (a, b) => a + b,
			};

			demoDotD.setLibraryPath(libraryModulesPath);
			demoDotD.loadModules({ passThroughParameters }, localCallback);
		};

		console.log(`\n\nASYNCHRONOUS DEMO =====================================`);

		const callback = (err, demoDotD) => {
			console.log(demoDotD.toString());
			demoDotD.demo1();
			demoDotD.demo2(10, 7);
		};
		
		asynchronousDemo(callback);
	};


// ================================================================================
// demo1.js

#!/usr/bin/env node
'use strict';
// Suppress punycode deprecation warning
process.noDeprecation = true;

const moduleName = __filename.replace(__dirname + '/', '').replace(/.js$/, ''); //this just seems to come in handy a lot

//START OF moduleFunction() ============================================================
const moduleFunction = ({ moduleName } = {}) => ({ dotD, passThroughParameters } = {}) => {

	const workingFunction = () => {
		console.log(`${passThroughParameters.message} [${moduleName}]`);
		return 'hello';
	};
	

	dotD.library.add(moduleName, workingFunction);
};

//END OF moduleFunction() ============================================================

module.exports = moduleFunction({ moduleName }); //runs it right now
//END OF moduleFunction() ============================================================

module.exports = moduleFunction({ moduleName })({});


// ================================================================================
//demo2.js

#!/usr/bin/env node
'use strict';
// Suppress punycode deprecation warning
process.noDeprecation = true;

const moduleName = __filename.replace(__dirname + '/', '').replace(/.js$/, ''); //this just seems to come in handy a lot

//START OF moduleFunction() ============================================================
const moduleFunction = ({ moduleName } = {}) => ({ dotD, passThroughParameters } = {}) => {

	const workingFunction = (arg1, arg2) => {
		console.log(`Pass Through Function: ${arg1}+${arg2}=${passThroughParameters.add(arg1, arg2)} [${moduleName}]`);
		return 'hello';
	};
	

	dotD.library.add(moduleName, workingFunction);
};

//END OF moduleFunction() ============================================================

module.exports = moduleFunction({ moduleName }); //runs it right now


HISTORY

v1.05 - cleaned up toString() report, returns exception list (or err if callback) if needed, added qtools-functional-library
v1.04 - Now tolerates (and reports) directories and files that are not modules.


HISTORY

v1.04 - Now tolerates (and reports) directories and files that are not modules.
